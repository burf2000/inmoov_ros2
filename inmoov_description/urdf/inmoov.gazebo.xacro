<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <!-- ============================================================
       Convenience: 180° limits (centered ±90°) and default force
       ============================================================ -->
  <xacro:property name="SERVO_MIN" value="-1.5707963267948966"/> <!-- -π/2 -->
  <xacro:property name="SERVO_MAX" value=" 1.5707963267948966"/> <!-- +π/2 -->
  <xacro:property name="FORCE"     value="200.0"/>                 <!-- Nm-ish; tune -->

  <!-- Small helper to declare one position-only joint with real torque -->
  <xacro:macro name="pos_only_joint" params="jname cmd_min:=${SERVO_MIN} cmd_max:=${SERVO_MAX} kp:=60.0 kd:=1.0 ki:=0.0 fmax:=${FORCE}">
    <joint name="${jname}">
      <command_interface name="position">
        <param name="position_proportional_gain">${kp}</param>
        <param name="position_d_gain">${kd}</param>
        <param name="position_i_gain">${ki}</param>
        <param name="position_max_force">${fmax}</param>
        <!-- note the renamed params here -->
        <param name="min">${cmd_min}</param>
        <param name="max">${cmd_max}</param>
      </command_interface>
      <state_interface name="position"/>
    </joint>
  </xacro:macro>



  <!-- ============================================================
       ros2_control for Gazebo Sim (position-only on all joints)
       ============================================================ -->
  <ros2_control name="inmoov_system" type="system">
    <hardware>
      <plugin>gz_ros2_control/GazeboSimSystem</plugin>
      <!-- Keep hardware section minimal; per-joint params above actually take effect -->
    </hardware>

    <!-- torso / neck / head -->
    <xacro:pos_only_joint jname="waist_pan_joint"/>
    <xacro:pos_only_joint jname="waist_roll_joint"/>
    <xacro:pos_only_joint jname="head_roll_joint"/>
    <xacro:pos_only_joint jname="head_tilt_joint"/>
    <xacro:pos_only_joint jname="head_pan_joint"/>

    <!-- jaw / eyes -->
    <xacro:pos_only_joint jname="jaw_joint"/>
    <xacro:pos_only_joint jname="eyes_tilt_joint"/>
    <xacro:pos_only_joint jname="eyes_pan_joint"/>

    <!-- right arm -->
    <xacro:pos_only_joint jname="r_shoulder_lift_joint"/>
    <xacro:pos_only_joint jname="r_upper_arm_roll_joint"/>
    <xacro:pos_only_joint jname="r_elbow_flex_joint"/>
    <xacro:pos_only_joint jname="r_shoulder_out_joint"/>
    <xacro:pos_only_joint jname="r_wrist_roll_joint" cmd_min="-3.141592653589793" cmd_max="3.141592653589793"/>

    <!-- left arm -->
    <xacro:pos_only_joint jname="l_shoulder_lift_joint"/>
    <xacro:pos_only_joint jname="l_upper_arm_roll_joint"/>
    <xacro:pos_only_joint jname="l_elbow_flex_joint"/>
    <xacro:pos_only_joint jname="l_shoulder_out_joint"/>
    <xacro:pos_only_joint jname="l_wrist_roll_joint" cmd_min="-3.141592653589793" cmd_max="3.141592653589793"/>

    <!-- left hand -->
    <xacro:pos_only_joint jname="l_thumb_joint"/>
    <xacro:pos_only_joint jname="l_index_joint"/>
    <xacro:pos_only_joint jname="l_middle_joint"/>
    <xacro:pos_only_joint jname="l_ring_joint"/>
    <xacro:pos_only_joint jname="l_pinky_joint"/>

    <!-- right hand -->
    <xacro:pos_only_joint jname="r_thumb_joint"/>
    <xacro:pos_only_joint jname="r_index_joint"/>
    <xacro:pos_only_joint jname="r_middle_joint"/>
    <xacro:pos_only_joint jname="r_ring_joint"/>
    <xacro:pos_only_joint jname="r_pinky_joint"/>
  </ros2_control>

  <!-- Gazebo Sim system plugin loader -->
  <gazebo>
    <plugin filename="libgz_ros2_control-system.so"
            name="gz_ros2_control::GazeboSimROS2ControlPlugin">
      <parameters>$(find inmoov_description)/config/controllers.yaml</parameters>
    </plugin>
  </gazebo>

  <!-- (colors etc below this line are fine to keep as you had) -->
</robot>
